
# Face Shape Classification and Hairstyle Recommendation System

## 프로젝트 개요
이 프로젝트는 사용자의 얼굴형을 분류하고, 그에 맞는 헤어스타일을 추천하는 시스템입니다. 이 시스템은 얼굴 이미지 데이터를 입력받아, 얼굴형을 Oval, Square, Round, Heart, Triangle 등 5가지 형태로 분류하는 모델을 기반으로 작동합니다. 모델은 EfficientNetB0을 사용하여 훈련되었으며, TensorFlow와 Keras를 활용하여 구축되었습니다. 이 시스템은 웹 애플리케이션을 통해 사용자가 업로드한 이미지를 분석하고, 그에 맞는 얼굴형을 예측하여 추천합니다.

## 기능
### 얼굴형 분류:
- 입력받은 얼굴 이미지를 분석하여 5가지 얼굴형 중 하나로 분류합니다.
- 얼굴형은 Oval, Square, Round, Heart, Triangle로 분류됩니다.

### 머리 스타일 추천:
- 얼굴형에 맞는 헤어스타일을 추천합니다. 예를 들어, Oval 얼굴형에 적합한 스타일을 추천합니다.

### 모델 훈련 및 평가:
- TensorFlow를 사용해 모델을 훈련하고 평가합니다.
- 모델 훈련에 EfficientNetB0 모델을 사용하여 높은 정확도를 목표로 합니다.

### 웹 애플리케이션:
- Flask를 이용한 웹 애플리케이션으로, 사용자는 이미지를 업로드하여 얼굴형을 예측받을 수 있습니다.
- 업로드된 이미지는 서버로 전송되면, 훈련된 모델을 사용하여 예측된 얼굴형을 반환하고, 그에 맞는 헤어스타일을 추천합니다.

## 사용 기술
- **TensorFlow**: 모델 훈련 및 예측에 사용
- **Keras**: 신경망 구축 및 훈련
- **OpenCV**: 이미지 전처리 및 얼굴 분석
- **Flask**: 웹 애플리케이션 구축
- **NumPy**: 데이터 처리
- **scikit-learn**: 레이블 인코딩

## 프로젝트 구성
### `image_processing.py`:
- 데이터 로딩, 이미지 전처리 및 레이블 인코딩을 수행하는 모듈입니다. 이미지를 224x224 크기로 조정하고, 정규화 후 모델에 입력합니다.

### `model_training.py`:
- EfficientNetB0 모델을 사용하여 얼굴형 분류 모델을 훈련하는 모듈입니다. 데이터 증강을 적용하여 모델을 학습시키고, 학습된 모델을 저장합니다.

### `predict.py`:
- 저장된 모델을 로드하여 새로운 이미지에 대해 예측을 수행하는 모듈입니다. 이미지를 모델의 입력 형식에 맞게 전처리하고, 예측된 얼굴형을 반환합니다.

### `main.py`:
- 전체 훈련 과정을 관리하는 메인 스크립트입니다. 데이터셋을 로드하고, 모델을 훈련시키며, 훈련된 모델을 저장합니다.

### `app.py`:
- Flask 웹 애플리케이션을 실행하는 스크립트입니다. 사용자가 업로드한 이미지를 받아서 예측된 얼굴형을 반환하고, 이를 웹 페이지에 표시합니다.

## 설치 및 실행 방법
### 1. 프로젝트 클론
```bash
git clone https://github.com/yourusername/FaceShape-Hairstyle.git
cd FaceShape-Hairstyle
```

### 2. 의존성 설치
```bash
pip install -r requirements.txt
```

### 3. 모델 훈련
훈련된 모델을 얻기 위해 `main.py`를 실행하여 모델을 훈련시킵니다.

```bash
python main.py
```
훈련이 완료되면 모델이 `efficientnet_face_shape_model_updated.keras` 파일로 저장됩니다.

### 4. 웹 애플리케이션 실행
훈련된 모델을 웹 애플리케이션에서 사용하려면 `app.py`를 실행합니다.

```bash
python app.py
```
웹 브라우저에서 `http://127.0.0.1:5000`을 열어 얼굴형 예측 및 헤어스타일 추천 기능을 확인할 수 있습니다.

### 5. 예시 이미지 예측
웹 애플리케이션에서 얼굴형을 예측하려면 사용자가 이미지를 업로드하면 됩니다. 업로드된 이미지는 모델을 통해 처리되어 예측된 얼굴형과 추천된 헤어스타일을 제공합니다.

## 얼굴형 및 헤어스타일 추천
프로젝트는 사용자가 업로드한 이미지를 바탕으로 얼굴형을 예측하고, 그에 맞는 헤어스타일을 추천합니다. 아래는 각 얼굴형에 따른 헤어스타일 추천입니다:

### 타원형 얼굴형의 헤어스타일
- 타원형 얼굴 형태는 가장 이상적인 형태로, 균형 있고 조화로운 형태를 가지고 있으며 다양한 헤어스타일이 잘 어울립니다.
- 머리 길이: 길게 자르거나 숏컷 스타일 등 다양한 길이의 스타일링이 가능하며, 모든 스타일에 잘 어울립니다.

### 사각형 얼굴형의 헤어스타일
- 사각형 얼굴 형태는 턱과 이마의 길이가 비슷한 형태입니다.
- 강인하고 남성적인 이미지를 가지고 있어, 강조된 헤어스타일이 잘 어울립니다.
- 추천 스타일: 스퀘어 컷, 콤마 스타일, 사이드 프론트 등.

### 둥근 얼굴형의 헤어스타일
- 둥근 얼굴 형태는 머리카락 스타일링에 따라 얼굴의 모양이 달라질 수 있습니다.
- 추천 스타일: 헤어 라인을 올려주는 롱 머리 스타일, 사이드 파트, 사이드 스윗, 빅 번 등이 잘 어울립니다.

### 하트형 얼굴형의 헤어스타일
- 하트형 얼굴 형태는 이마가 넓고 턱이 좁은 형태로 여성적이고 고상한 느낌을 줍니다.
- 앞머리를 내리는 스타일은 이마의 크기를 가리고 얼굴을 더욱 균형 있게 보이도록 해줍니다.

### 삼각형 얼굴형의 헤어스타일
- 삼각형 얼굴 형태는 턱이 넓고 이마가 좁은 형태입니다.
- 사이드 파트, 양옆을 짧게 자른 스타일 등이 잘 어울립니다.
